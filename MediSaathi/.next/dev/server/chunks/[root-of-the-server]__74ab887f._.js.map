{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///D:/MediSaathi/lib/supabase.ts"],"sourcesContent":["import { createClient } from '@supabase/supabase-js'\r\n\r\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL!\r\nconst supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!\r\n\r\nexport const supabase = createClient(supabaseUrl, supabaseAnonKey)\r\n\r\n// Database Types\r\nexport type Database = {\r\n  public: {\r\n    Tables: {\r\n      users: {\r\n        Row: {\r\n          id: string\r\n          email: string\r\n          full_name: string | null\r\n          avatar_url: string | null\r\n          user_type: 'patient' | 'doctor' | 'hospital'\r\n          phone: string | null\r\n          date_of_birth: string | null\r\n          gender: string | null\r\n          address: string | null\r\n          created_at: string\r\n          updated_at: string\r\n        }\r\n        Insert: {\r\n          id?: string\r\n          email: string\r\n          full_name?: string | null\r\n          avatar_url?: string | null\r\n          user_type: 'patient' | 'doctor' | 'hospital'\r\n          phone?: string | null\r\n          date_of_birth?: string | null\r\n          gender?: string | null\r\n          address?: string | null\r\n          created_at?: string\r\n          updated_at?: string\r\n        }\r\n        Update: {\r\n          id?: string\r\n          email?: string\r\n          full_name?: string | null\r\n          avatar_url?: string | null\r\n          user_type?: 'patient' | 'doctor' | 'hospital'\r\n          phone?: string | null\r\n          date_of_birth?: string | null\r\n          gender?: string | null\r\n          address?: string | null\r\n          updated_at?: string\r\n        }\r\n      }\r\n      family_members: {\r\n        Row: {\r\n          id: string\r\n          user_id: string\r\n          full_name: string\r\n          relationship: string\r\n          date_of_birth: string\r\n          gender: string\r\n          phone: string | null\r\n          emergency_contact: boolean\r\n          created_at: string\r\n          updated_at: string\r\n        }\r\n        Insert: {\r\n          id?: string\r\n          user_id: string\r\n          full_name: string\r\n          relationship: string\r\n          date_of_birth: string\r\n          gender: string\r\n          phone?: string | null\r\n          emergency_contact?: boolean\r\n          created_at?: string\r\n          updated_at?: string\r\n        }\r\n        Update: {\r\n          id?: string\r\n          user_id?: string\r\n          full_name?: string\r\n          relationship?: string\r\n          date_of_birth?: string\r\n          gender?: string\r\n          phone?: string | null\r\n          emergency_contact?: boolean\r\n          updated_at?: string\r\n        }\r\n      }\r\n      doctors: {\r\n        Row: {\r\n          id: string\r\n          user_id: string\r\n          specialty: string\r\n          license_number: string\r\n          experience_years: number\r\n          education: string | null\r\n          hospital_id: string | null\r\n          consultation_fee: number | null\r\n          available_days: string[]\r\n          available_hours: string\r\n          bio: string | null\r\n          rating: number\r\n          total_patients: number\r\n          created_at: string\r\n          updated_at: string\r\n        }\r\n        Insert: {\r\n          id?: string\r\n          user_id: string\r\n          specialty: string\r\n          license_number: string\r\n          experience_years: number\r\n          education?: string | null\r\n          hospital_id?: string | null\r\n          consultation_fee?: number | null\r\n          available_days?: string[]\r\n          available_hours?: string\r\n          bio?: string | null\r\n          rating?: number\r\n          total_patients?: number\r\n          created_at?: string\r\n          updated_at?: string\r\n        }\r\n        Update: {\r\n          id?: string\r\n          user_id?: string\r\n          specialty?: string\r\n          license_number?: string\r\n          experience_years?: number\r\n          education?: string | null\r\n          hospital_id?: string | null\r\n          consultation_fee?: number | null\r\n          available_days?: string[]\r\n          available_hours?: string\r\n          bio?: string | null\r\n          rating?: number\r\n          total_patients?: number\r\n          updated_at?: string\r\n        }\r\n      }\r\n      hospitals: {\r\n        Row: {\r\n          id: string\r\n          user_id: string\r\n          name: string\r\n          address: string\r\n          phone: string\r\n          email: string\r\n          website: string | null\r\n          license_number: string\r\n          total_beds: number\r\n          available_beds: number\r\n          departments: string[]\r\n          services: string[]\r\n          emergency_services: boolean\r\n          rating: number\r\n          created_at: string\r\n          updated_at: string\r\n        }\r\n        Insert: {\r\n          id?: string\r\n          user_id: string\r\n          name: string\r\n          address: string\r\n          phone: string\r\n          email: string\r\n          website?: string | null\r\n          license_number: string\r\n          total_beds: number\r\n          available_beds: number\r\n          departments: string[]\r\n          services: string[]\r\n          emergency_services?: boolean\r\n          rating?: number\r\n          created_at?: string\r\n          updated_at?: string\r\n        }\r\n        Update: {\r\n          id?: string\r\n          user_id?: string\r\n          name?: string\r\n          address?: string\r\n          phone?: string\r\n          email?: string\r\n          website?: string | null\r\n          license_number?: string\r\n          total_beds?: number\r\n          available_beds?: number\r\n          departments?: string[]\r\n          services?: string[]\r\n          emergency_services?: boolean\r\n          rating?: number\r\n          updated_at?: string\r\n        }\r\n      }\r\n      health_records: {\r\n        Row: {\r\n          id: string\r\n          user_id: string\r\n          family_member_id: string | null\r\n          title: string\r\n          type: 'lab_report' | 'prescription' | 'xray' | 'scan' | 'consultation' | 'other'\r\n          file_url: string | null\r\n          file_type: string | null\r\n          content: string | null\r\n          doctor_id: string | null\r\n          hospital_id: string | null\r\n          date_recorded: string\r\n          ai_summary: string | null\r\n          tags: string[]\r\n          is_critical: boolean\r\n          created_at: string\r\n          updated_at: string\r\n        }\r\n        Insert: {\r\n          id?: string\r\n          user_id: string\r\n          family_member_id?: string | null\r\n          title: string\r\n          type: 'lab_report' | 'prescription' | 'xray' | 'scan' | 'consultation' | 'other'\r\n          file_url?: string | null\r\n          file_type?: string | null\r\n          content?: string | null\r\n          doctor_id?: string | null\r\n          hospital_id?: string | null\r\n          date_recorded: string\r\n          ai_summary?: string | null\r\n          tags?: string[]\r\n          is_critical?: boolean\r\n          created_at?: string\r\n          updated_at?: string\r\n        }\r\n        Update: {\r\n          id?: string\r\n          user_id?: string\r\n          family_member_id?: string | null\r\n          title?: string\r\n          type?: 'lab_report' | 'prescription' | 'xray' | 'scan' | 'consultation' | 'other'\r\n          file_url?: string | null\r\n          file_type?: string | null\r\n          content?: string | null\r\n          doctor_id?: string | null\r\n          hospital_id?: string | null\r\n          date_recorded?: string\r\n          ai_summary?: string | null\r\n          tags?: string[]\r\n          is_critical?: boolean\r\n          updated_at?: string\r\n        }\r\n      }\r\n      vital_signs: {\r\n        Row: {\r\n          id: string\r\n          user_id: string\r\n          family_member_id: string | null\r\n          type: 'blood_pressure' | 'heart_rate' | 'temperature' | 'weight' | 'height' | 'blood_sugar' | 'oxygen_saturation'\r\n          value: string\r\n          unit: string\r\n          notes: string | null\r\n          recorded_at: string\r\n          created_at: string\r\n        }\r\n        Insert: {\r\n          id?: string\r\n          user_id: string\r\n          family_member_id?: string | null\r\n          type: 'blood_pressure' | 'heart_rate' | 'temperature' | 'weight' | 'height' | 'blood_sugar' | 'oxygen_saturation'\r\n          value: string\r\n          unit: string\r\n          notes?: string | null\r\n          recorded_at: string\r\n          created_at?: string\r\n        }\r\n        Update: {\r\n          id?: string\r\n          user_id?: string\r\n          family_member_id?: string | null\r\n          type?: 'blood_pressure' | 'heart_rate' | 'temperature' | 'weight' | 'height' | 'blood_sugar' | 'oxygen_saturation'\r\n          value?: string\r\n          unit?: string\r\n          notes?: string | null\r\n          recorded_at?: string\r\n        }\r\n      }\r\n      appointments: {\r\n        Row: {\r\n          id: string\r\n          patient_id: string\r\n          doctor_id: string\r\n          hospital_id: string | null\r\n          appointment_date: string\r\n          appointment_time: string\r\n          duration: number\r\n          type: 'consultation' | 'follow_up' | 'emergency' | 'telemedicine'\r\n          status: 'scheduled' | 'confirmed' | 'in_progress' | 'completed' | 'cancelled' | 'no_show'\r\n          reason: string\r\n          notes: string | null\r\n          prescription_id: string | null\r\n          fee: number | null\r\n          payment_status: 'pending' | 'paid' | 'refunded'\r\n          created_at: string\r\n          updated_at: string\r\n        }\r\n        Insert: {\r\n          id?: string\r\n          patient_id: string\r\n          doctor_id: string\r\n          hospital_id?: string | null\r\n          appointment_date: string\r\n          appointment_time: string\r\n          duration?: number\r\n          type: 'consultation' | 'follow_up' | 'emergency' | 'telemedicine'\r\n          status?: 'scheduled' | 'confirmed' | 'in_progress' | 'completed' | 'cancelled' | 'no_show'\r\n          reason: string\r\n          notes?: string | null\r\n          prescription_id?: string | null\r\n          fee?: number | null\r\n          payment_status?: 'pending' | 'paid' | 'refunded'\r\n          created_at?: string\r\n          updated_at?: string\r\n        }\r\n        Update: {\r\n          id?: string\r\n          patient_id?: string\r\n          doctor_id?: string\r\n          hospital_id?: string | null\r\n          appointment_date?: string\r\n          appointment_time?: string\r\n          duration?: number\r\n          type?: 'consultation' | 'follow_up' | 'emergency' | 'telemedicine'\r\n          status?: 'scheduled' | 'confirmed' | 'in_progress' | 'completed' | 'cancelled' | 'no_show'\r\n          reason?: string\r\n          notes?: string | null\r\n          prescription_id?: string | null\r\n          fee?: number | null\r\n          payment_status?: 'pending' | 'paid' | 'refunded'\r\n          updated_at?: string\r\n        }\r\n      }\r\n      prescriptions: {\r\n        Row: {\r\n          id: string\r\n          doctor_id: string\r\n          patient_id: string\r\n          appointment_id: string | null\r\n          medications: any[]\r\n          instructions: string | null\r\n          valid_until: string\r\n          status: 'active' | 'expired' | 'cancelled'\r\n          created_at: string\r\n          updated_at: string\r\n        }\r\n        Insert: {\r\n          id?: string\r\n          doctor_id: string\r\n          patient_id: string\r\n          appointment_id?: string | null\r\n          medications: any[]\r\n          instructions?: string | null\r\n          valid_until: string\r\n          status?: 'active' | 'expired' | 'cancelled'\r\n          created_at?: string\r\n          updated_at?: string\r\n        }\r\n        Update: {\r\n          id?: string\r\n          doctor_id?: string\r\n          patient_id?: string\r\n          appointment_id?: string | null\r\n          medications?: any[]\r\n          instructions?: string | null\r\n          valid_until?: string\r\n          status?: 'active' | 'expired' | 'cancelled'\r\n          updated_at?: string\r\n        }\r\n      }\r\n    }\r\n  }\r\n}"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM;AACN,MAAM;AAEC,MAAM,WAAW,IAAA,uNAAY,EAAC,aAAa"}},
    {"offset": {"line": 59, "column": 0}, "map": {"version":3,"sources":["file:///D:/MediSaathi/lib/services/vital-sign.service.ts"],"sourcesContent":["import { supabase } from '@/lib/supabase'\r\nimport type { Database } from '@/lib/supabase'\r\n\r\ntype VitalSign = Database['public']['Tables']['vital_signs']['Row']\r\ntype VitalSignInsert = Database['public']['Tables']['vital_signs']['Insert']\r\ntype VitalSignUpdate = Database['public']['Tables']['vital_signs']['Update']\r\n\r\nexport class VitalSignService {\r\n  // Get vital signs for user/family member\r\n  static async getVitalSigns(userId: string, familyMemberId?: string, type?: string) {\r\n    try {\r\n      let query = supabase\r\n        .from('vital_signs')\r\n        .select('*')\r\n        .eq('user_id', userId)\r\n\r\n      if (familyMemberId) {\r\n        query = query.eq('family_member_id', familyMemberId)\r\n      }\r\n\r\n      if (type) {\r\n        query = query.eq('type', type)\r\n      }\r\n\r\n      const { data, error } = await query\r\n        .order('recorded_at', { ascending: false })\r\n\r\n      if (error) throw error\r\n      return { data, error: null }\r\n    } catch (error) {\r\n      return { data: null, error }\r\n    }\r\n  }\r\n\r\n  // Add vital sign reading\r\n  static async addVitalSign(vitalData: VitalSignInsert) {\r\n    try {\r\n      const { data, error } = await supabase\r\n        .from('vital_signs')\r\n        .insert(vitalData)\r\n        .select()\r\n        .single()\r\n\r\n      if (error) throw error\r\n      return { data, error: null }\r\n    } catch (error) {\r\n      return { data: null, error }\r\n    }\r\n  }\r\n\r\n  // Update vital sign reading\r\n  static async updateVitalSign(vitalId: string, updates: VitalSignUpdate) {\r\n    try {\r\n      const { data, error } = await supabase\r\n        .from('vital_signs')\r\n        .update(updates)\r\n        .eq('id', vitalId)\r\n        .select()\r\n        .single()\r\n\r\n      if (error) throw error\r\n      return { data, error: null }\r\n    } catch (error) {\r\n      return { data: null, error }\r\n    }\r\n  }\r\n\r\n  // Delete vital sign reading\r\n  static async deleteVitalSign(vitalId: string) {\r\n    try {\r\n      const { error } = await supabase\r\n        .from('vital_signs')\r\n        .delete()\r\n        .eq('id', vitalId)\r\n\r\n      if (error) throw error\r\n      return { error: null }\r\n    } catch (error) {\r\n      return { error }\r\n    }\r\n  }\r\n\r\n  // Get latest readings for all vital types\r\n  static async getLatestReadings(userId: string, familyMemberId?: string) {\r\n    try {\r\n      const vitalTypes = [\r\n        'blood_pressure', 'heart_rate', 'temperature', \r\n        'weight', 'height', 'blood_sugar', 'oxygen_saturation'\r\n      ]\r\n\r\n      const latestReadings = await Promise.all(\r\n        vitalTypes.map(async (type) => {\r\n          let query = supabase\r\n            .from('vital_signs')\r\n            .select('*')\r\n            .eq('user_id', userId)\r\n            .eq('type', type)\r\n\r\n          if (familyMemberId) {\r\n            query = query.eq('family_member_id', familyMemberId)\r\n          }\r\n\r\n          const { data, error } = await query\r\n            .order('recorded_at', { ascending: false })\r\n            .limit(1)\r\n\r\n          return { type, data: data?.[0] || null, error }\r\n        })\r\n      )\r\n\r\n      return { data: latestReadings, error: null }\r\n    } catch (error) {\r\n      return { data: null, error }\r\n    }\r\n  }\r\n\r\n  // Get vital signs analytics\r\n  static async getVitalAnalytics(userId: string, type: string, days: number = 30) {\r\n    try {\r\n      const startDate = new Date()\r\n      startDate.setDate(startDate.getDate() - days)\r\n\r\n      const { data, error } = await supabase\r\n        .from('vital_signs')\r\n        .select('*')\r\n        .eq('user_id', userId)\r\n        .eq('type', type)\r\n        .gte('recorded_at', startDate.toISOString())\r\n        .order('recorded_at', { ascending: true })\r\n\r\n      if (error) throw error\r\n\r\n      // Calculate analytics\r\n      const analytics = {\r\n        readings: data || [],\r\n        average: 0,\r\n        min: 0,\r\n        max: 0,\r\n        trend: 'stable' as 'up' | 'down' | 'stable'\r\n      }\r\n\r\n      if (data && data.length > 0) {\r\n        const numericValues = data\r\n          .map(reading => parseFloat(reading.value.split('/')[0])) // Handle BP format\r\n          .filter(val => !isNaN(val))\r\n\r\n        if (numericValues.length > 0) {\r\n          analytics.average = numericValues.reduce((a, b) => a + b, 0) / numericValues.length\r\n          analytics.min = Math.min(...numericValues)\r\n          analytics.max = Math.max(...numericValues)\r\n\r\n          // Simple trend calculation\r\n          if (numericValues.length > 1) {\r\n            const recent = numericValues.slice(-5).reduce((a, b) => a + b, 0) / Math.min(5, numericValues.length)\r\n            const older = numericValues.slice(0, -5).reduce((a, b) => a + b, 0) / Math.max(1, numericValues.length - 5)\r\n            \r\n            if (recent > older * 1.05) analytics.trend = 'up'\r\n            else if (recent < older * 0.95) analytics.trend = 'down'\r\n          }\r\n        }\r\n      }\r\n\r\n      return { data: analytics, error: null }\r\n    } catch (error) {\r\n      return { data: null, error }\r\n    }\r\n  }\r\n\r\n  // Check for abnormal readings\r\n  static checkAbnormalReading(type: string, value: string): { isAbnormal: boolean, severity: 'low' | 'medium' | 'high', message?: string } {\r\n    const numericValue = parseFloat(value.split('/')[0])\r\n    \r\n    switch (type) {\r\n      case 'blood_pressure':\r\n        const [systolic, diastolic] = value.split('/').map(v => parseFloat(v))\r\n        if (systolic > 180 || diastolic > 120) {\r\n          return { isAbnormal: true, severity: 'high', message: 'Hypertensive crisis - seek immediate medical attention' }\r\n        } else if (systolic > 140 || diastolic > 90) {\r\n          return { isAbnormal: true, severity: 'medium', message: 'High blood pressure - consult your doctor' }\r\n        } else if (systolic < 90 || diastolic < 60) {\r\n          return { isAbnormal: true, severity: 'medium', message: 'Low blood pressure - monitor closely' }\r\n        }\r\n        break\r\n\r\n      case 'heart_rate':\r\n        if (numericValue > 100) {\r\n          return { isAbnormal: true, severity: 'medium', message: 'Elevated heart rate - consider rest' }\r\n        } else if (numericValue < 60) {\r\n          return { isAbnormal: true, severity: 'low', message: 'Low heart rate - monitor if symptomatic' }\r\n        }\r\n        break\r\n\r\n      case 'temperature':\r\n        if (numericValue > 100.4) {\r\n          return { isAbnormal: true, severity: 'medium', message: 'Fever detected - monitor and consider medical advice' }\r\n        } else if (numericValue < 95) {\r\n          return { isAbnormal: true, severity: 'high', message: 'Low body temperature - seek medical attention' }\r\n        }\r\n        break\r\n\r\n      case 'blood_sugar':\r\n        if (numericValue > 200) {\r\n          return { isAbnormal: true, severity: 'high', message: 'High blood sugar - check with healthcare provider' }\r\n        } else if (numericValue < 70) {\r\n          return { isAbnormal: true, severity: 'medium', message: 'Low blood sugar - consume glucose' }\r\n        }\r\n        break\r\n\r\n      case 'oxygen_saturation':\r\n        if (numericValue < 95) {\r\n          return { isAbnormal: true, severity: 'high', message: 'Low oxygen saturation - seek immediate medical attention' }\r\n        }\r\n        break\r\n    }\r\n\r\n    return { isAbnormal: false, severity: 'low' }\r\n  }\r\n\r\n  // Get vital signs reminders\r\n  static async getVitalReminders(userId: string) {\r\n    try {\r\n      // Check when last readings were taken for each vital type\r\n      const vitalTypes = ['blood_pressure', 'heart_rate', 'temperature', 'weight', 'blood_sugar']\r\n      const reminders = []\r\n\r\n      for (const type of vitalTypes) {\r\n        const { data } = await this.getVitalSigns(userId, undefined, type)\r\n        \r\n        if (!data || data.length === 0) {\r\n          reminders.push({\r\n            type,\r\n            message: `No ${type.replace('_', ' ')} readings recorded`,\r\n            priority: 'low'\r\n          })\r\n        } else {\r\n          const lastReading = new Date(data[0].recorded_at)\r\n          const daysSinceLastReading = Math.floor((Date.now() - lastReading.getTime()) / (1000 * 60 * 60 * 24))\r\n          \r\n          if (daysSinceLastReading > 7) {\r\n            reminders.push({\r\n              type,\r\n              message: `Last ${type.replace('_', ' ')} reading was ${daysSinceLastReading} days ago`,\r\n              priority: daysSinceLastReading > 30 ? 'high' : 'medium'\r\n            })\r\n          }\r\n        }\r\n      }\r\n\r\n      return { data: reminders, error: null }\r\n    } catch (error) {\r\n      return { data: null, error }\r\n    }\r\n  }\r\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 352, "column": 0}, "map": {"version":3,"sources":["file:///D:/MediSaathi/app/api/vital-signs/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server'\r\nimport { VitalSignService } from '@/lib/services/vital-sign.service'\r\n\r\nexport async function GET(request: NextRequest) {\r\n  try {\r\n    const { searchParams } = new URL(request.url)\r\n    const action = searchParams.get('action')\r\n    const userId = searchParams.get('userId')\r\n    const familyMemberId = searchParams.get('familyMemberId')\r\n    const type = searchParams.get('type')\r\n    const days = searchParams.get('days')\r\n\r\n    if (!userId) {\r\n      return NextResponse.json({ success: false, error: 'User ID required' }, { status: 400 })\r\n    }\r\n\r\n    switch (action) {\r\n      case 'get-vitals':\r\n        const vitalsResult = await VitalSignService.getVitalSigns(\r\n          userId, \r\n          familyMemberId || undefined, \r\n          type || undefined\r\n        )\r\n        if (vitalsResult.error) throw vitalsResult.error\r\n        return NextResponse.json({ success: true, data: vitalsResult.data })\r\n\r\n      case 'latest-readings':\r\n        const latestResult = await VitalSignService.getLatestReadings(\r\n          userId, \r\n          familyMemberId || undefined\r\n        )\r\n        if (latestResult.error) throw latestResult.error\r\n        return NextResponse.json({ success: true, data: latestResult.data })\r\n\r\n      case 'analytics':\r\n        if (!type) {\r\n          return NextResponse.json({ success: false, error: 'Vital type required for analytics' }, { status: 400 })\r\n        }\r\n        const analyticsResult = await VitalSignService.getVitalAnalytics(\r\n          userId, \r\n          type, \r\n          days ? parseInt(days) : 30\r\n        )\r\n        if (analyticsResult.error) throw analyticsResult.error\r\n        return NextResponse.json({ success: true, data: analyticsResult.data })\r\n\r\n      case 'reminders':\r\n        const remindersResult = await VitalSignService.getVitalReminders(userId)\r\n        if (remindersResult.error) throw remindersResult.error\r\n        return NextResponse.json({ success: true, data: remindersResult.data })\r\n\r\n      default:\r\n        return NextResponse.json({ success: false, error: 'Invalid action' }, { status: 400 })\r\n    }\r\n  } catch (error) {\r\n    console.error('Vital Signs API Error:', error)\r\n    return NextResponse.json({ success: false, error: 'Internal server error' }, { status: 500 })\r\n  }\r\n}\r\n\r\nexport async function POST(request: NextRequest) {\r\n  try {\r\n    const body = await request.json()\r\n    const { vitalData } = body\r\n\r\n    if (!vitalData.user_id || !vitalData.type || !vitalData.value || !vitalData.unit) {\r\n      return NextResponse.json({ \r\n        success: false, \r\n        error: 'Required vital sign data missing (user_id, type, value, unit)' \r\n      }, { status: 400 })\r\n    }\r\n\r\n    // Check for abnormal readings\r\n    const abnormalCheck = VitalSignService.checkAbnormalReading(vitalData.type, vitalData.value)\r\n\r\n    const result = await VitalSignService.addVitalSign({\r\n      ...vitalData,\r\n      recorded_at: vitalData.recorded_at || new Date().toISOString()\r\n    })\r\n\r\n    if (result.error) throw result.error\r\n\r\n    return NextResponse.json({ \r\n      success: true, \r\n      data: result.data,\r\n      abnormal: abnormalCheck,\r\n      message: 'Vital sign recorded successfully' \r\n    })\r\n  } catch (error) {\r\n    console.error('Vital Sign Recording Error:', error)\r\n    return NextResponse.json({ success: false, error: 'Failed to record vital sign' }, { status: 500 })\r\n  }\r\n}\r\n\r\nexport async function PUT(request: NextRequest) {\r\n  try {\r\n    const body = await request.json()\r\n    const { vitalId, updates } = body\r\n\r\n    if (!vitalId) {\r\n      return NextResponse.json({ success: false, error: 'Vital sign ID required' }, { status: 400 })\r\n    }\r\n\r\n    const result = await VitalSignService.updateVitalSign(vitalId, updates)\r\n    if (result.error) throw result.error\r\n\r\n    return NextResponse.json({ \r\n      success: true, \r\n      data: result.data,\r\n      message: 'Vital sign updated successfully' \r\n    })\r\n  } catch (error) {\r\n    console.error('Vital Sign Update Error:', error)\r\n    return NextResponse.json({ success: false, error: 'Failed to update vital sign' }, { status: 500 })\r\n  }\r\n}\r\n\r\nexport async function DELETE(request: NextRequest) {\r\n  try {\r\n    const { searchParams } = new URL(request.url)\r\n    const vitalId = searchParams.get('vitalId')\r\n\r\n    if (!vitalId) {\r\n      return NextResponse.json({ success: false, error: 'Vital sign ID required' }, { status: 400 })\r\n    }\r\n\r\n    const { error } = await VitalSignService.deleteVitalSign(vitalId)\r\n    if (error) throw error\r\n\r\n    return NextResponse.json({ \r\n      success: true, \r\n      message: 'Vital sign deleted successfully' \r\n    })\r\n  } catch (error) {\r\n    console.error('Vital Sign Delete Error:', error)\r\n    return NextResponse.json({ success: false, error: 'Failed to delete vital sign' }, { status: 500 })\r\n  }\r\n}"],"names":[],"mappings":"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"}}]
}