{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 34, "column": 0}, "map": {"version":3,"sources":["file:///D:/MediSaathi/lib/supabase.ts"],"sourcesContent":["import { createClient } from '@supabase/supabase-js'\r\n\r\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL!\r\nconst supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!\r\n\r\nexport const supabase = createClient(supabaseUrl, supabaseAnonKey)\r\n\r\n// Database Types\r\nexport type Database = {\r\n  public: {\r\n    Tables: {\r\n      users: {\r\n        Row: {\r\n          id: string\r\n          email: string\r\n          full_name: string | null\r\n          avatar_url: string | null\r\n          user_type: 'patient' | 'doctor' | 'hospital'\r\n          phone: string | null\r\n          date_of_birth: string | null\r\n          gender: string | null\r\n          address: string | null\r\n          created_at: string\r\n          updated_at: string\r\n        }\r\n        Insert: {\r\n          id?: string\r\n          email: string\r\n          full_name?: string | null\r\n          avatar_url?: string | null\r\n          user_type: 'patient' | 'doctor' | 'hospital'\r\n          phone?: string | null\r\n          date_of_birth?: string | null\r\n          gender?: string | null\r\n          address?: string | null\r\n          created_at?: string\r\n          updated_at?: string\r\n        }\r\n        Update: {\r\n          id?: string\r\n          email?: string\r\n          full_name?: string | null\r\n          avatar_url?: string | null\r\n          user_type?: 'patient' | 'doctor' | 'hospital'\r\n          phone?: string | null\r\n          date_of_birth?: string | null\r\n          gender?: string | null\r\n          address?: string | null\r\n          updated_at?: string\r\n        }\r\n      }\r\n      family_members: {\r\n        Row: {\r\n          id: string\r\n          user_id: string\r\n          full_name: string\r\n          relationship: string\r\n          date_of_birth: string\r\n          gender: string\r\n          phone: string | null\r\n          emergency_contact: boolean\r\n          created_at: string\r\n          updated_at: string\r\n        }\r\n        Insert: {\r\n          id?: string\r\n          user_id: string\r\n          full_name: string\r\n          relationship: string\r\n          date_of_birth: string\r\n          gender: string\r\n          phone?: string | null\r\n          emergency_contact?: boolean\r\n          created_at?: string\r\n          updated_at?: string\r\n        }\r\n        Update: {\r\n          id?: string\r\n          user_id?: string\r\n          full_name?: string\r\n          relationship?: string\r\n          date_of_birth?: string\r\n          gender?: string\r\n          phone?: string | null\r\n          emergency_contact?: boolean\r\n          updated_at?: string\r\n        }\r\n      }\r\n      doctors: {\r\n        Row: {\r\n          id: string\r\n          user_id: string\r\n          specialty: string\r\n          license_number: string\r\n          experience_years: number\r\n          education: string | null\r\n          hospital_id: string | null\r\n          consultation_fee: number | null\r\n          available_days: string[]\r\n          available_hours: string\r\n          bio: string | null\r\n          rating: number\r\n          total_patients: number\r\n          created_at: string\r\n          updated_at: string\r\n        }\r\n        Insert: {\r\n          id?: string\r\n          user_id: string\r\n          specialty: string\r\n          license_number: string\r\n          experience_years: number\r\n          education?: string | null\r\n          hospital_id?: string | null\r\n          consultation_fee?: number | null\r\n          available_days?: string[]\r\n          available_hours?: string\r\n          bio?: string | null\r\n          rating?: number\r\n          total_patients?: number\r\n          created_at?: string\r\n          updated_at?: string\r\n        }\r\n        Update: {\r\n          id?: string\r\n          user_id?: string\r\n          specialty?: string\r\n          license_number?: string\r\n          experience_years?: number\r\n          education?: string | null\r\n          hospital_id?: string | null\r\n          consultation_fee?: number | null\r\n          available_days?: string[]\r\n          available_hours?: string\r\n          bio?: string | null\r\n          rating?: number\r\n          total_patients?: number\r\n          updated_at?: string\r\n        }\r\n      }\r\n      hospitals: {\r\n        Row: {\r\n          id: string\r\n          user_id: string\r\n          name: string\r\n          address: string\r\n          phone: string\r\n          email: string\r\n          website: string | null\r\n          license_number: string\r\n          total_beds: number\r\n          available_beds: number\r\n          departments: string[]\r\n          services: string[]\r\n          emergency_services: boolean\r\n          rating: number\r\n          created_at: string\r\n          updated_at: string\r\n        }\r\n        Insert: {\r\n          id?: string\r\n          user_id: string\r\n          name: string\r\n          address: string\r\n          phone: string\r\n          email: string\r\n          website?: string | null\r\n          license_number: string\r\n          total_beds: number\r\n          available_beds: number\r\n          departments: string[]\r\n          services: string[]\r\n          emergency_services?: boolean\r\n          rating?: number\r\n          created_at?: string\r\n          updated_at?: string\r\n        }\r\n        Update: {\r\n          id?: string\r\n          user_id?: string\r\n          name?: string\r\n          address?: string\r\n          phone?: string\r\n          email?: string\r\n          website?: string | null\r\n          license_number?: string\r\n          total_beds?: number\r\n          available_beds?: number\r\n          departments?: string[]\r\n          services?: string[]\r\n          emergency_services?: boolean\r\n          rating?: number\r\n          updated_at?: string\r\n        }\r\n      }\r\n      health_records: {\r\n        Row: {\r\n          id: string\r\n          user_id: string\r\n          family_member_id: string | null\r\n          title: string\r\n          type: 'lab_report' | 'prescription' | 'xray' | 'scan' | 'consultation' | 'other'\r\n          file_url: string | null\r\n          file_type: string | null\r\n          content: string | null\r\n          doctor_id: string | null\r\n          hospital_id: string | null\r\n          date_recorded: string\r\n          ai_summary: string | null\r\n          tags: string[]\r\n          is_critical: boolean\r\n          created_at: string\r\n          updated_at: string\r\n        }\r\n        Insert: {\r\n          id?: string\r\n          user_id: string\r\n          family_member_id?: string | null\r\n          title: string\r\n          type: 'lab_report' | 'prescription' | 'xray' | 'scan' | 'consultation' | 'other'\r\n          file_url?: string | null\r\n          file_type?: string | null\r\n          content?: string | null\r\n          doctor_id?: string | null\r\n          hospital_id?: string | null\r\n          date_recorded: string\r\n          ai_summary?: string | null\r\n          tags?: string[]\r\n          is_critical?: boolean\r\n          created_at?: string\r\n          updated_at?: string\r\n        }\r\n        Update: {\r\n          id?: string\r\n          user_id?: string\r\n          family_member_id?: string | null\r\n          title?: string\r\n          type?: 'lab_report' | 'prescription' | 'xray' | 'scan' | 'consultation' | 'other'\r\n          file_url?: string | null\r\n          file_type?: string | null\r\n          content?: string | null\r\n          doctor_id?: string | null\r\n          hospital_id?: string | null\r\n          date_recorded?: string\r\n          ai_summary?: string | null\r\n          tags?: string[]\r\n          is_critical?: boolean\r\n          updated_at?: string\r\n        }\r\n      }\r\n      vital_signs: {\r\n        Row: {\r\n          id: string\r\n          user_id: string\r\n          family_member_id: string | null\r\n          type: 'blood_pressure' | 'heart_rate' | 'temperature' | 'weight' | 'height' | 'blood_sugar' | 'oxygen_saturation'\r\n          value: string\r\n          unit: string\r\n          notes: string | null\r\n          recorded_at: string\r\n          created_at: string\r\n        }\r\n        Insert: {\r\n          id?: string\r\n          user_id: string\r\n          family_member_id?: string | null\r\n          type: 'blood_pressure' | 'heart_rate' | 'temperature' | 'weight' | 'height' | 'blood_sugar' | 'oxygen_saturation'\r\n          value: string\r\n          unit: string\r\n          notes?: string | null\r\n          recorded_at: string\r\n          created_at?: string\r\n        }\r\n        Update: {\r\n          id?: string\r\n          user_id?: string\r\n          family_member_id?: string | null\r\n          type?: 'blood_pressure' | 'heart_rate' | 'temperature' | 'weight' | 'height' | 'blood_sugar' | 'oxygen_saturation'\r\n          value?: string\r\n          unit?: string\r\n          notes?: string | null\r\n          recorded_at?: string\r\n        }\r\n      }\r\n      appointments: {\r\n        Row: {\r\n          id: string\r\n          patient_id: string\r\n          doctor_id: string\r\n          hospital_id: string | null\r\n          appointment_date: string\r\n          appointment_time: string\r\n          duration: number\r\n          type: 'consultation' | 'follow_up' | 'emergency' | 'telemedicine'\r\n          status: 'scheduled' | 'confirmed' | 'in_progress' | 'completed' | 'cancelled' | 'no_show'\r\n          reason: string\r\n          notes: string | null\r\n          prescription_id: string | null\r\n          fee: number | null\r\n          payment_status: 'pending' | 'paid' | 'refunded'\r\n          created_at: string\r\n          updated_at: string\r\n        }\r\n        Insert: {\r\n          id?: string\r\n          patient_id: string\r\n          doctor_id: string\r\n          hospital_id?: string | null\r\n          appointment_date: string\r\n          appointment_time: string\r\n          duration?: number\r\n          type: 'consultation' | 'follow_up' | 'emergency' | 'telemedicine'\r\n          status?: 'scheduled' | 'confirmed' | 'in_progress' | 'completed' | 'cancelled' | 'no_show'\r\n          reason: string\r\n          notes?: string | null\r\n          prescription_id?: string | null\r\n          fee?: number | null\r\n          payment_status?: 'pending' | 'paid' | 'refunded'\r\n          created_at?: string\r\n          updated_at?: string\r\n        }\r\n        Update: {\r\n          id?: string\r\n          patient_id?: string\r\n          doctor_id?: string\r\n          hospital_id?: string | null\r\n          appointment_date?: string\r\n          appointment_time?: string\r\n          duration?: number\r\n          type?: 'consultation' | 'follow_up' | 'emergency' | 'telemedicine'\r\n          status?: 'scheduled' | 'confirmed' | 'in_progress' | 'completed' | 'cancelled' | 'no_show'\r\n          reason?: string\r\n          notes?: string | null\r\n          prescription_id?: string | null\r\n          fee?: number | null\r\n          payment_status?: 'pending' | 'paid' | 'refunded'\r\n          updated_at?: string\r\n        }\r\n      }\r\n      prescriptions: {\r\n        Row: {\r\n          id: string\r\n          doctor_id: string\r\n          patient_id: string\r\n          appointment_id: string | null\r\n          medications: any[]\r\n          instructions: string | null\r\n          valid_until: string\r\n          status: 'active' | 'expired' | 'cancelled'\r\n          created_at: string\r\n          updated_at: string\r\n        }\r\n        Insert: {\r\n          id?: string\r\n          doctor_id: string\r\n          patient_id: string\r\n          appointment_id?: string | null\r\n          medications: any[]\r\n          instructions?: string | null\r\n          valid_until: string\r\n          status?: 'active' | 'expired' | 'cancelled'\r\n          created_at?: string\r\n          updated_at?: string\r\n        }\r\n        Update: {\r\n          id?: string\r\n          doctor_id?: string\r\n          patient_id?: string\r\n          appointment_id?: string | null\r\n          medications?: any[]\r\n          instructions?: string | null\r\n          valid_until?: string\r\n          status?: 'active' | 'expired' | 'cancelled'\r\n          updated_at?: string\r\n        }\r\n      }\r\n    }\r\n  }\r\n}"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM;AACN,MAAM;AAEC,MAAM,WAAW,IAAA,iKAAY,EAAC,aAAa"}},
    {"offset": {"line": 47, "column": 0}, "map": {"version":3,"sources":["file:///D:/MediSaathi/pages/api/auth/%5B...nextauth%5D.ts"],"sourcesContent":["import NextAuth from 'next-auth'\r\nimport GoogleProvider from 'next-auth/providers/google'\r\nimport { supabase } from '@/lib/supabase'\r\n\r\nexport default NextAuth({\r\n  providers: [\r\n    GoogleProvider({\r\n      clientId: process.env.GOOGLE_CLIENT_ID!,\r\n      clientSecret: process.env.GOOGLE_CLIENT_SECRET!,\r\n    }),\r\n  ],\r\n  callbacks: {\r\n    async signIn({ user, account, profile }) {\r\n      if (account?.provider === 'google') {\r\n        try {\r\n          // Check if user profile exists in our custom users table\r\n          const { data: existingUser } = await supabase\r\n            .from('users')\r\n            .select('*')\r\n            .eq('email', user.email)\r\n            .single()\r\n\r\n          // If user doesn't exist, create a profile with default patient type\r\n          if (!existingUser) {\r\n            const { error } = await supabase\r\n              .from('users')\r\n              .insert({\r\n                email: user.email!,\r\n                full_name: user.name || '',\r\n                avatar_url: user.image || '',\r\n                user_type: 'patient', // Default to patient for Google OAuth\r\n                created_at: new Date().toISOString(),\r\n                updated_at: new Date().toISOString()\r\n              })\r\n\r\n            if (error) {\r\n              console.error('Error creating user profile:', error)\r\n              return false\r\n            }\r\n          }\r\n          return true\r\n        } catch (error) {\r\n          console.error('Sign-in error:', error)\r\n          return false\r\n        }\r\n      }\r\n      return true\r\n    },\r\n    async session({ session, token }) {\r\n      // Add custom user data to session\r\n      if (session?.user?.email) {\r\n        const { data: userData } = await supabase\r\n          .from('users')\r\n          .select('*')\r\n          .eq('email', session.user.email)\r\n          .single()\r\n\r\n        if (userData) {\r\n          session.user.userType = userData.user_type\r\n          session.user.userId = userData.id\r\n          session.user.fullName = userData.full_name\r\n        }\r\n      }\r\n      return session\r\n    },\r\n    async redirect({ url, baseUrl }) {\r\n      // Custom redirect logic based on user type\r\n      if (url.startsWith('/')) {\r\n        return `${baseUrl}${url}`\r\n      }\r\n      // If it's a callback, check user type and redirect appropriately\r\n      if (url.startsWith(baseUrl)) {\r\n        try {\r\n          // Get user session to determine redirect\r\n          const response = await fetch(`${baseUrl}/api/auth/session`)\r\n          const session = await response.json()\r\n          \r\n          if (session?.user?.userType) {\r\n            return `${baseUrl}/${session.user.userType}-dashboard`\r\n          }\r\n        } catch (error) {\r\n          console.error('Redirect error:', error)\r\n        }\r\n        return `${baseUrl}/patient-dashboard` // Default fallback\r\n      }\r\n      return baseUrl\r\n    },\r\n    async jwt({ token, user, account }) {\r\n      // Persist user data in JWT\r\n      if (user) {\r\n        token.userId = user.id\r\n        token.email = user.email\r\n      }\r\n      return token\r\n    }\r\n  },\r\n  pages: {\r\n    signIn: '/login',\r\n    error: '/auth/error',\r\n  },\r\n  session: {\r\n    strategy: 'jwt',\r\n  },\r\n  debug: process.env.NODE_ENV === 'development',\r\n})"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;uCAEe,IAAA,4HAAQ,EAAC;IACtB,WAAW;QACT,IAAA,0KAAc,EAAC;YACb,UAAU,QAAQ,GAAG,CAAC,gBAAgB;YACtC,cAAc,QAAQ,GAAG,CAAC,oBAAoB;QAChD;KACD;IACD,WAAW;QACT,MAAM,QAAO,EAAE,IAAI,EAAE,OAAO,EAAE,OAAO,EAAE;YACrC,IAAI,SAAS,aAAa,UAAU;gBAClC,IAAI;oBACF,yDAAyD;oBACzD,MAAM,EAAE,MAAM,YAAY,EAAE,GAAG,MAAM,kIAAQ,CAC1C,IAAI,CAAC,SACL,MAAM,CAAC,KACP,EAAE,CAAC,SAAS,KAAK,KAAK,EACtB,MAAM;oBAET,oEAAoE;oBACpE,IAAI,CAAC,cAAc;wBACjB,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,kIAAQ,CAC7B,IAAI,CAAC,SACL,MAAM,CAAC;4BACN,OAAO,KAAK,KAAK;4BACjB,WAAW,KAAK,IAAI,IAAI;4BACxB,YAAY,KAAK,KAAK,IAAI;4BAC1B,WAAW;4BACX,YAAY,IAAI,OAAO,WAAW;4BAClC,YAAY,IAAI,OAAO,WAAW;wBACpC;wBAEF,IAAI,OAAO;4BACT,QAAQ,KAAK,CAAC,gCAAgC;4BAC9C,OAAO;wBACT;oBACF;oBACA,OAAO;gBACT,EAAE,OAAO,OAAO;oBACd,QAAQ,KAAK,CAAC,kBAAkB;oBAChC,OAAO;gBACT;YACF;YACA,OAAO;QACT;QACA,MAAM,SAAQ,EAAE,OAAO,EAAE,KAAK,EAAE;YAC9B,kCAAkC;YAClC,IAAI,SAAS,MAAM,OAAO;gBACxB,MAAM,EAAE,MAAM,QAAQ,EAAE,GAAG,MAAM,kIAAQ,CACtC,IAAI,CAAC,SACL,MAAM,CAAC,KACP,EAAE,CAAC,SAAS,QAAQ,IAAI,CAAC,KAAK,EAC9B,MAAM;gBAET,IAAI,UAAU;oBACZ,QAAQ,IAAI,CAAC,QAAQ,GAAG,SAAS,SAAS;oBAC1C,QAAQ,IAAI,CAAC,MAAM,GAAG,SAAS,EAAE;oBACjC,QAAQ,IAAI,CAAC,QAAQ,GAAG,SAAS,SAAS;gBAC5C;YACF;YACA,OAAO;QACT;QACA,MAAM,UAAS,EAAE,GAAG,EAAE,OAAO,EAAE;YAC7B,2CAA2C;YAC3C,IAAI,IAAI,UAAU,CAAC,MAAM;gBACvB,OAAO,GAAG,UAAU,KAAK;YAC3B;YACA,iEAAiE;YACjE,IAAI,IAAI,UAAU,CAAC,UAAU;gBAC3B,IAAI;oBACF,yCAAyC;oBACzC,MAAM,WAAW,MAAM,MAAM,GAAG,QAAQ,iBAAiB,CAAC;oBAC1D,MAAM,UAAU,MAAM,SAAS,IAAI;oBAEnC,IAAI,SAAS,MAAM,UAAU;wBAC3B,OAAO,GAAG,QAAQ,CAAC,EAAE,QAAQ,IAAI,CAAC,QAAQ,CAAC,UAAU,CAAC;oBACxD;gBACF,EAAE,OAAO,OAAO;oBACd,QAAQ,KAAK,CAAC,mBAAmB;gBACnC;gBACA,OAAO,GAAG,QAAQ,kBAAkB,CAAC,CAAC,mBAAmB;;YAC3D;YACA,OAAO;QACT;QACA,MAAM,KAAI,EAAE,KAAK,EAAE,IAAI,EAAE,OAAO,EAAE;YAChC,2BAA2B;YAC3B,IAAI,MAAM;gBACR,MAAM,MAAM,GAAG,KAAK,EAAE;gBACtB,MAAM,KAAK,GAAG,KAAK,KAAK;YAC1B;YACA,OAAO;QACT;IACF;IACA,OAAO;QACL,QAAQ;QACR,OAAO;IACT;IACA,SAAS;QACP,UAAU;IACZ;IACA,OAAO,oDAAyB;AAClC"}}]
}