{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///D:/MediSaathi/lib/supabase.ts"],"sourcesContent":["import { createClient } from '@supabase/supabase-js'\r\n\r\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL!\r\nconst supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!\r\n\r\nexport const supabase = createClient(supabaseUrl, supabaseAnonKey)\r\n\r\n// Database Types\r\nexport type Database = {\r\n  public: {\r\n    Tables: {\r\n      users: {\r\n        Row: {\r\n          id: string\r\n          email: string\r\n          full_name: string | null\r\n          avatar_url: string | null\r\n          user_type: 'patient' | 'doctor' | 'hospital'\r\n          phone: string | null\r\n          date_of_birth: string | null\r\n          gender: string | null\r\n          address: string | null\r\n          created_at: string\r\n          updated_at: string\r\n        }\r\n        Insert: {\r\n          id?: string\r\n          email: string\r\n          full_name?: string | null\r\n          avatar_url?: string | null\r\n          user_type: 'patient' | 'doctor' | 'hospital'\r\n          phone?: string | null\r\n          date_of_birth?: string | null\r\n          gender?: string | null\r\n          address?: string | null\r\n          created_at?: string\r\n          updated_at?: string\r\n        }\r\n        Update: {\r\n          id?: string\r\n          email?: string\r\n          full_name?: string | null\r\n          avatar_url?: string | null\r\n          user_type?: 'patient' | 'doctor' | 'hospital'\r\n          phone?: string | null\r\n          date_of_birth?: string | null\r\n          gender?: string | null\r\n          address?: string | null\r\n          updated_at?: string\r\n        }\r\n      }\r\n      family_members: {\r\n        Row: {\r\n          id: string\r\n          user_id: string\r\n          full_name: string\r\n          relationship: string\r\n          date_of_birth: string\r\n          gender: string\r\n          phone: string | null\r\n          emergency_contact: boolean\r\n          created_at: string\r\n          updated_at: string\r\n        }\r\n        Insert: {\r\n          id?: string\r\n          user_id: string\r\n          full_name: string\r\n          relationship: string\r\n          date_of_birth: string\r\n          gender: string\r\n          phone?: string | null\r\n          emergency_contact?: boolean\r\n          created_at?: string\r\n          updated_at?: string\r\n        }\r\n        Update: {\r\n          id?: string\r\n          user_id?: string\r\n          full_name?: string\r\n          relationship?: string\r\n          date_of_birth?: string\r\n          gender?: string\r\n          phone?: string | null\r\n          emergency_contact?: boolean\r\n          updated_at?: string\r\n        }\r\n      }\r\n      doctors: {\r\n        Row: {\r\n          id: string\r\n          user_id: string\r\n          specialty: string\r\n          license_number: string\r\n          experience_years: number\r\n          education: string | null\r\n          hospital_id: string | null\r\n          consultation_fee: number | null\r\n          available_days: string[]\r\n          available_hours: string\r\n          bio: string | null\r\n          rating: number\r\n          total_patients: number\r\n          created_at: string\r\n          updated_at: string\r\n        }\r\n        Insert: {\r\n          id?: string\r\n          user_id: string\r\n          specialty: string\r\n          license_number: string\r\n          experience_years: number\r\n          education?: string | null\r\n          hospital_id?: string | null\r\n          consultation_fee?: number | null\r\n          available_days?: string[]\r\n          available_hours?: string\r\n          bio?: string | null\r\n          rating?: number\r\n          total_patients?: number\r\n          created_at?: string\r\n          updated_at?: string\r\n        }\r\n        Update: {\r\n          id?: string\r\n          user_id?: string\r\n          specialty?: string\r\n          license_number?: string\r\n          experience_years?: number\r\n          education?: string | null\r\n          hospital_id?: string | null\r\n          consultation_fee?: number | null\r\n          available_days?: string[]\r\n          available_hours?: string\r\n          bio?: string | null\r\n          rating?: number\r\n          total_patients?: number\r\n          updated_at?: string\r\n        }\r\n      }\r\n      hospitals: {\r\n        Row: {\r\n          id: string\r\n          user_id: string\r\n          name: string\r\n          address: string\r\n          phone: string\r\n          email: string\r\n          website: string | null\r\n          license_number: string\r\n          total_beds: number\r\n          available_beds: number\r\n          departments: string[]\r\n          services: string[]\r\n          emergency_services: boolean\r\n          rating: number\r\n          created_at: string\r\n          updated_at: string\r\n        }\r\n        Insert: {\r\n          id?: string\r\n          user_id: string\r\n          name: string\r\n          address: string\r\n          phone: string\r\n          email: string\r\n          website?: string | null\r\n          license_number: string\r\n          total_beds: number\r\n          available_beds: number\r\n          departments: string[]\r\n          services: string[]\r\n          emergency_services?: boolean\r\n          rating?: number\r\n          created_at?: string\r\n          updated_at?: string\r\n        }\r\n        Update: {\r\n          id?: string\r\n          user_id?: string\r\n          name?: string\r\n          address?: string\r\n          phone?: string\r\n          email?: string\r\n          website?: string | null\r\n          license_number?: string\r\n          total_beds?: number\r\n          available_beds?: number\r\n          departments?: string[]\r\n          services?: string[]\r\n          emergency_services?: boolean\r\n          rating?: number\r\n          updated_at?: string\r\n        }\r\n      }\r\n      health_records: {\r\n        Row: {\r\n          id: string\r\n          user_id: string\r\n          family_member_id: string | null\r\n          title: string\r\n          type: 'lab_report' | 'prescription' | 'xray' | 'scan' | 'consultation' | 'other'\r\n          file_url: string | null\r\n          file_type: string | null\r\n          content: string | null\r\n          doctor_id: string | null\r\n          hospital_id: string | null\r\n          date_recorded: string\r\n          ai_summary: string | null\r\n          tags: string[]\r\n          is_critical: boolean\r\n          created_at: string\r\n          updated_at: string\r\n        }\r\n        Insert: {\r\n          id?: string\r\n          user_id: string\r\n          family_member_id?: string | null\r\n          title: string\r\n          type: 'lab_report' | 'prescription' | 'xray' | 'scan' | 'consultation' | 'other'\r\n          file_url?: string | null\r\n          file_type?: string | null\r\n          content?: string | null\r\n          doctor_id?: string | null\r\n          hospital_id?: string | null\r\n          date_recorded: string\r\n          ai_summary?: string | null\r\n          tags?: string[]\r\n          is_critical?: boolean\r\n          created_at?: string\r\n          updated_at?: string\r\n        }\r\n        Update: {\r\n          id?: string\r\n          user_id?: string\r\n          family_member_id?: string | null\r\n          title?: string\r\n          type?: 'lab_report' | 'prescription' | 'xray' | 'scan' | 'consultation' | 'other'\r\n          file_url?: string | null\r\n          file_type?: string | null\r\n          content?: string | null\r\n          doctor_id?: string | null\r\n          hospital_id?: string | null\r\n          date_recorded?: string\r\n          ai_summary?: string | null\r\n          tags?: string[]\r\n          is_critical?: boolean\r\n          updated_at?: string\r\n        }\r\n      }\r\n      vital_signs: {\r\n        Row: {\r\n          id: string\r\n          user_id: string\r\n          family_member_id: string | null\r\n          type: 'blood_pressure' | 'heart_rate' | 'temperature' | 'weight' | 'height' | 'blood_sugar' | 'oxygen_saturation'\r\n          value: string\r\n          unit: string\r\n          notes: string | null\r\n          recorded_at: string\r\n          created_at: string\r\n        }\r\n        Insert: {\r\n          id?: string\r\n          user_id: string\r\n          family_member_id?: string | null\r\n          type: 'blood_pressure' | 'heart_rate' | 'temperature' | 'weight' | 'height' | 'blood_sugar' | 'oxygen_saturation'\r\n          value: string\r\n          unit: string\r\n          notes?: string | null\r\n          recorded_at: string\r\n          created_at?: string\r\n        }\r\n        Update: {\r\n          id?: string\r\n          user_id?: string\r\n          family_member_id?: string | null\r\n          type?: 'blood_pressure' | 'heart_rate' | 'temperature' | 'weight' | 'height' | 'blood_sugar' | 'oxygen_saturation'\r\n          value?: string\r\n          unit?: string\r\n          notes?: string | null\r\n          recorded_at?: string\r\n        }\r\n      }\r\n      appointments: {\r\n        Row: {\r\n          id: string\r\n          patient_id: string\r\n          doctor_id: string\r\n          hospital_id: string | null\r\n          appointment_date: string\r\n          appointment_time: string\r\n          duration: number\r\n          type: 'consultation' | 'follow_up' | 'emergency' | 'telemedicine'\r\n          status: 'scheduled' | 'confirmed' | 'in_progress' | 'completed' | 'cancelled' | 'no_show'\r\n          reason: string\r\n          notes: string | null\r\n          prescription_id: string | null\r\n          fee: number | null\r\n          payment_status: 'pending' | 'paid' | 'refunded'\r\n          created_at: string\r\n          updated_at: string\r\n        }\r\n        Insert: {\r\n          id?: string\r\n          patient_id: string\r\n          doctor_id: string\r\n          hospital_id?: string | null\r\n          appointment_date: string\r\n          appointment_time: string\r\n          duration?: number\r\n          type: 'consultation' | 'follow_up' | 'emergency' | 'telemedicine'\r\n          status?: 'scheduled' | 'confirmed' | 'in_progress' | 'completed' | 'cancelled' | 'no_show'\r\n          reason: string\r\n          notes?: string | null\r\n          prescription_id?: string | null\r\n          fee?: number | null\r\n          payment_status?: 'pending' | 'paid' | 'refunded'\r\n          created_at?: string\r\n          updated_at?: string\r\n        }\r\n        Update: {\r\n          id?: string\r\n          patient_id?: string\r\n          doctor_id?: string\r\n          hospital_id?: string | null\r\n          appointment_date?: string\r\n          appointment_time?: string\r\n          duration?: number\r\n          type?: 'consultation' | 'follow_up' | 'emergency' | 'telemedicine'\r\n          status?: 'scheduled' | 'confirmed' | 'in_progress' | 'completed' | 'cancelled' | 'no_show'\r\n          reason?: string\r\n          notes?: string | null\r\n          prescription_id?: string | null\r\n          fee?: number | null\r\n          payment_status?: 'pending' | 'paid' | 'refunded'\r\n          updated_at?: string\r\n        }\r\n      }\r\n      prescriptions: {\r\n        Row: {\r\n          id: string\r\n          doctor_id: string\r\n          patient_id: string\r\n          appointment_id: string | null\r\n          medications: any[]\r\n          instructions: string | null\r\n          valid_until: string\r\n          status: 'active' | 'expired' | 'cancelled'\r\n          created_at: string\r\n          updated_at: string\r\n        }\r\n        Insert: {\r\n          id?: string\r\n          doctor_id: string\r\n          patient_id: string\r\n          appointment_id?: string | null\r\n          medications: any[]\r\n          instructions?: string | null\r\n          valid_until: string\r\n          status?: 'active' | 'expired' | 'cancelled'\r\n          created_at?: string\r\n          updated_at?: string\r\n        }\r\n        Update: {\r\n          id?: string\r\n          doctor_id?: string\r\n          patient_id?: string\r\n          appointment_id?: string | null\r\n          medications?: any[]\r\n          instructions?: string | null\r\n          valid_until?: string\r\n          status?: 'active' | 'expired' | 'cancelled'\r\n          updated_at?: string\r\n        }\r\n      }\r\n    }\r\n  }\r\n}"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM;AACN,MAAM;AAEC,MAAM,WAAW,IAAA,uNAAY,EAAC,aAAa"}},
    {"offset": {"line": 59, "column": 0}, "map": {"version":3,"sources":["file:///D:/MediSaathi/app/api/doctors/patients/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server'\r\nimport { supabase } from '@/lib/supabase'\r\n\r\nexport async function GET(request: NextRequest) {\r\n  try {\r\n    const { searchParams } = new URL(request.url)\r\n    const doctorId = searchParams.get('doctorId')\r\n    const action = searchParams.get('action') || 'patients'\r\n    const recent = searchParams.get('recent')\r\n    const critical = searchParams.get('critical')\r\n    const limit = searchParams.get('limit')\r\n\r\n    if (!doctorId) {\r\n      return NextResponse.json({ \r\n        success: false, \r\n        error: 'Doctor ID is required' \r\n      }, { status: 400 })\r\n    }\r\n\r\n    if (action === 'patients' || !action) {\r\n      // Get patients for this doctor based on appointments\r\n      let query = supabase\r\n        .from('appointments')\r\n        .select(`\r\n          patient_id,\r\n          patients:patient_id (\r\n            id,\r\n            primary_condition,\r\n            risk_level,\r\n            critical_notes,\r\n            last_appointment,\r\n            users:user_id (\r\n              id,\r\n              full_name,\r\n              email,\r\n              avatar_url,\r\n              date_of_birth\r\n            )\r\n          )\r\n        `)\r\n        .eq('doctor_id', doctorId)\r\n\r\n      // Apply filters\r\n      if (critical === 'true') {\r\n        query = query.eq('patients.risk_level', 'high')\r\n      }\r\n\r\n      if (recent === 'true') {\r\n        query = query.order('created_at', { ascending: false })\r\n      }\r\n\r\n      if (limit) {\r\n        query = query.limit(parseInt(limit))\r\n      }\r\n\r\n      const { data: appointments, error } = await query\r\n\r\n      if (error) {\r\n        console.error('Database error:', error)\r\n        return NextResponse.json({ \r\n          success: false, \r\n          error: 'Failed to fetch patients',\r\n          details: error.message\r\n        }, { status: 500 })\r\n      }\r\n\r\n      // Extract unique patients from appointments\r\n      const patientsMap = new Map()\r\n      appointments?.forEach((appointment: any) => {\r\n        if (appointment.patients && !patientsMap.has(appointment.patient_id)) {\r\n          patientsMap.set(appointment.patient_id, appointment.patients)\r\n        }\r\n      })\r\n\r\n      const patients = Array.from(patientsMap.values())\r\n\r\n      if (action === 'patients') {\r\n        return NextResponse.json({ \r\n          success: true, \r\n          data: patients,\r\n          total: patients.length\r\n        })\r\n      }\r\n    }\r\n\r\n    return NextResponse.json({ \r\n      success: false, \r\n      error: 'Invalid action' \r\n    }, { status: 400 })\r\n\r\n  } catch (error) {\r\n    console.error('Doctors API error:', error)\r\n    return NextResponse.json({ \r\n      success: false, \r\n      error: 'Internal server error',\r\n      details: error instanceof Error ? error.message : 'Unknown error'\r\n    }, { status: 500 })\r\n  }\r\n}"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,eAAe,IAAI,OAAoB;IAC5C,IAAI;QACF,MAAM,EAAE,YAAY,EAAE,GAAG,IAAI,IAAI,QAAQ,GAAG;QAC5C,MAAM,WAAW,aAAa,GAAG,CAAC;QAClC,MAAM,SAAS,aAAa,GAAG,CAAC,aAAa;QAC7C,MAAM,SAAS,aAAa,GAAG,CAAC;QAChC,MAAM,WAAW,aAAa,GAAG,CAAC;QAClC,MAAM,QAAQ,aAAa,GAAG,CAAC;QAE/B,IAAI,CAAC,UAAU;YACb,OAAO,8JAAY,CAAC,IAAI,CAAC;gBACvB,SAAS;gBACT,OAAO;YACT,GAAG;gBAAE,QAAQ;YAAI;QACnB;QAEA,IAAI,WAAW,cAAc,CAAC,QAAQ;YACpC,qDAAqD;YACrD,IAAI,QAAQ,2IAAQ,CACjB,IAAI,CAAC,gBACL,MAAM,CAAC,CAAC;;;;;;;;;;;;;;;;QAgBT,CAAC,EACA,EAAE,CAAC,aAAa;YAEnB,gBAAgB;YAChB,IAAI,aAAa,QAAQ;gBACvB,QAAQ,MAAM,EAAE,CAAC,uBAAuB;YAC1C;YAEA,IAAI,WAAW,QAAQ;gBACrB,QAAQ,MAAM,KAAK,CAAC,cAAc;oBAAE,WAAW;gBAAM;YACvD;YAEA,IAAI,OAAO;gBACT,QAAQ,MAAM,KAAK,CAAC,SAAS;YAC/B;YAEA,MAAM,EAAE,MAAM,YAAY,EAAE,KAAK,EAAE,GAAG,MAAM;YAE5C,IAAI,OAAO;gBACT,QAAQ,KAAK,CAAC,mBAAmB;gBACjC,OAAO,8JAAY,CAAC,IAAI,CAAC;oBACvB,SAAS;oBACT,OAAO;oBACP,SAAS,MAAM,OAAO;gBACxB,GAAG;oBAAE,QAAQ;gBAAI;YACnB;YAEA,4CAA4C;YAC5C,MAAM,cAAc,IAAI;YACxB,cAAc,QAAQ,CAAC;gBACrB,IAAI,YAAY,QAAQ,IAAI,CAAC,YAAY,GAAG,CAAC,YAAY,UAAU,GAAG;oBACpE,YAAY,GAAG,CAAC,YAAY,UAAU,EAAE,YAAY,QAAQ;gBAC9D;YACF;YAEA,MAAM,WAAW,MAAM,IAAI,CAAC,YAAY,MAAM;YAE9C,IAAI,WAAW,YAAY;gBACzB,OAAO,8JAAY,CAAC,IAAI,CAAC;oBACvB,SAAS;oBACT,MAAM;oBACN,OAAO,SAAS,MAAM;gBACxB;YACF;QACF;QAEA,OAAO,8JAAY,CAAC,IAAI,CAAC;YACvB,SAAS;YACT,OAAO;QACT,GAAG;YAAE,QAAQ;QAAI;IAEnB,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,sBAAsB;QACpC,OAAO,8JAAY,CAAC,IAAI,CAAC;YACvB,SAAS;YACT,OAAO;YACP,SAAS,iBAAiB,QAAQ,MAAM,OAAO,GAAG;QACpD,GAAG;YAAE,QAAQ;QAAI;IACnB;AACF"}}]
}